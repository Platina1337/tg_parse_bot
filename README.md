# Telegram Parser Bot

Микросервисное приложение для парсинга сообщений из Telegram-каналов.

## Структура проекта

- `bot/` - Telegram бот на Pyrogram для взаимодействия с пользователем
- `parser/` - Микросервис на FastAPI для парсинга сообщений
- `shared/` - Общие компоненты и модели данных

## Функциональность

- Парсинг сообщений из каналов
- Пересылка сообщений в целевые каналы
- Управление множеством аккаунтов Telegram
- Добавление реакций на посты с нескольких аккаунтов

## Команды бота

- `/start` - Начать работу с ботом
- `/monitorings` - Управление мониторингами каналов
- `/sessions` - Управление сессиями Telegram аккаунтов
- `/reactions` - Управление реакциями на посты

## Установка и запуск

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Настройте конфигурацию в файлах:
- `bot/config.py`
- `parser/config.py`
- `shared/config.py`

3. Запустите сервисы:
```bash
docker-compose up
```

## Требования

- Python 3.8+
- Docker и Docker Compose
- Telegram API credentials 

## Запуск в режиме разработки

### Parser service
```bash
cd parser
venv/scripts/activate
cd ..
uvicorn parser.main:app --reload
```

### Bot service
```bash
cd bot
venv/scripts/activate
cd ..
python -m bot.bot_main
```

## Управление сессиями

Для управления множеством аккаунтов Telegram используйте команду `/sessions`. Теперь все сессии и их метаданные (alias, api_id, api_hash, phone, путь к .session, статус и т.д.) хранятся в базе данных. При запуске сервиса все существующие .session файлы автоматически импортируются в БД, и вы всегда видите полный список доступных сессий через API или команды.

Возможности:

1. Добавлять новые аккаунты (сессии) через API или команду
2. Автоматически импортировать все найденные .session файлы в папке `sessions/`
3. Назначать аккаунты для разных задач (парсинг, мониторинг, пересылка, реакции)
4. Получать список всех сессий и их статусов (активна/нет, назначение, alias, телефон и т.д.)
5. После перезапуска все сессии и назначения сохраняются

## Управление реакциями

Для добавления реакций на посты используйте команду `/reactions`. Функционал позволяет:

1. Добавлять реакции на конкретные сообщения
2. Использовать несколько аккаунтов для реакций
3. Выбирать эмодзи из доступных реакций